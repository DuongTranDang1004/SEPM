<script src="https://cdn.tailwindcss.com"></script>
<script>
    // Tailwind CSS configuration for the interface
    tailwind.config = {
        theme: {
            extend: {
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                },
                colors: {
                    'primary-blue': '#1e40af',
                    'primary-green': '#10b981',
                    'bg-dark': '#f3f4f6',
                }
            }
        }
    }
</script>

<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f3f4f6;
    }

    .card {
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
    }
    .question-answer-container {
        border-bottom: 1px solid #e5e7eb; /* Light gray separator */
        padding-bottom: 1rem;
        margin-bottom: 1rem;
    }
    .question-answer-container:last-child {
        border-bottom: none;
        margin-bottom: 0;
    }
</style>

<div class="p-6 md:p-10 min-h-screen flex flex-col items-center">
    <h1 class="text-3xl font-bold text-primary-blue mb-6">Broomate AI Matchmaker</h1>
    <p class="text-gray-600 mb-8 max-w-2xl text-center">Uses the Gemini API to simulate the automated scoring and Q&A process for finding a roommate, implementing conditional follow-up questions based on the compatibility score.</p>

    <!-- Main Input Area -->
    <div class="w-full max-w-4xl bg-white p-6 rounded-xl card">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">Current User Data (Client Profile)</h2>
        <textarea id="clientProfile" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue mb-4" placeholder="Example: Name: Nguyen Van A. Age: 22. Job: IT Student. Habits: Sleeps early (10 PM), likes quiet, non-smoker. Budget: 3-4 Million VND/month."></textarea>

        <h2 class="text-xl font-semibold mb-4 text-gray-800">Q&A History (Current Conversation)</h2>
        <div id="qaHistory" class="space-y-3 bg-gray-50 p-4 rounded-lg border border-gray-200 h-64 overflow-y-auto mb-4">
            <!-- History will be injected here -->
            <p class="text-gray-500 italic">No questions have been asked yet. Click 'Start' to begin.</p>
        </div>
        <div id="answerWarning" class="hidden p-3 mb-4 rounded-lg bg-red-100 text-red-700 font-medium">
            Please answer all outstanding questions before clicking 'Continue'.
        </div>

        <div class="flex space-x-4 mt-4">
            <button id="startAgent1" class="flex-1 px-4 py-2 bg-primary-green text-white font-medium rounded-lg hover:bg-green-600 transition duration-150 disabled:bg-gray-400" onclick="startMatching()">
                Start (Agent 1: 5 Questions)
            </button>
            <button id="continueAgent2" class="flex-1 px-4 py-2 bg-yellow-600 text-white font-medium rounded-lg hover:bg-yellow-700 transition duration-150 disabled:bg-gray-400" onclick="continueMatching()" disabled>
                Continue (Agent 2: Score/Ask More)
            </button>
        </div>
    </div>

    <!-- Results Area -->
    <div class="w-full max-w-4xl mt-6">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">Results and API Output</h2>
        <div id="resultOutput" class="bg-gray-800 text-white p-4 rounded-xl font-mono text-sm whitespace-pre-wrap card min-h-[100px] flex items-center justify-center">
            Awaiting Command...
        </div>

        <div id="loadingIndicator" class="hidden mt-4 text-center text-primary-blue font-medium">
            <svg class="animate-spin h-5 w-5 mr-3 inline text-primary-blue" viewBox="0 0 24 24">
                <!-- Icon Spinner -->
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            AI is processing the request... (May take a few seconds)
        </div>

        <div id="statusMessage" class="mt-4 p-3 rounded-lg text-center font-medium hidden"></div>
    </div>
</div>

<!-- Link to the external JavaScript file -->
<script src="AI_CompetiableScore.js"></script>